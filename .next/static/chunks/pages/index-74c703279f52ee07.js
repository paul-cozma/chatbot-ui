(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{48312:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(10977)}])},10977:function(e,t,r){"use strict";r.r(t),r.d(t,{__N_SSP:function(){return eM},default:function(){return eK}});var a,l,s=r(85893),n=r(33111),o=r(51668),i=r(63072),d=r(37096),c=r(67294);let x=e=>{let{size:t="1em",className:r=""}=e;return(0,s.jsxs)("svg",{stroke:"currentColor",fill:"none",strokeWidth:"2",viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"animate-spin ".concat(r),height:t,width:t,xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("line",{x1:"12",y1:"2",x2:"12",y2:"6"}),(0,s.jsx)("line",{x1:"12",y1:"18",x2:"12",y2:"22"}),(0,s.jsx)("line",{x1:"4.93",y1:"4.93",x2:"7.76",y2:"7.76"}),(0,s.jsx)("line",{x1:"16.24",y1:"16.24",x2:"19.07",y2:"19.07"}),(0,s.jsx)("line",{x1:"2",y1:"12",x2:"6",y2:"12"}),(0,s.jsx)("line",{x1:"18",y1:"12",x2:"22",y2:"12"}),(0,s.jsx)("line",{x1:"4.93",y1:"19.07",x2:"7.76",y2:"16.24"}),(0,s.jsx)("line",{x1:"16.24",y1:"7.76",x2:"19.07",y2:"4.93"})]})};var u=r(94568),m=r(21223),p=r(23461);let h=e=>{let{prompts:t,activePromptIndex:r,onSelect:a,onMouseOver:l,promptListRef:n}=e;return(0,s.jsx)("ul",{ref:n,className:"z-10 w-full rounded border border-black/10 bg-white shadow-[0_0_10px_rgba(0,0,0,0.10)] dark:border-neutral-500 dark:bg-[#343541] dark:text-white dark:shadow-[0_0_15px_rgba(0,0,0,0.10)] max-h-52 overflow-scroll",children:t.map((e,t)=>(0,s.jsx)("li",{className:"".concat(t===r?"bg-gray-200 dark:bg-[#202123] dark:text-black":""," cursor-pointer px-3 py-2 text-sm text-black dark:text-white"),onClick:e=>{e.preventDefault(),e.stopPropagation(),a()},onMouseEnter:()=>l(t),children:e.name},e.id))})},g=e=>{let{prompt:t,variables:r,onSubmit:a,onClose:l}=e,[n,o]=(0,c.useState)(r.map(e=>({key:e,value:""})).filter((e,t,r)=>r.findIndex(t=>t.key===e.key)===t)),i=(0,c.useRef)(null),d=(0,c.useRef)(null),x=(e,t)=>{o(r=>{let a=[...r];return a[e].value=t,a})},u=()=>{if(n.some(e=>""===e.value)){alert("Please fill out all variables");return}a(n.map(e=>e.value)),l()},m=e=>{"Enter"!==e.key||e.shiftKey?"Escape"===e.key&&l():(e.preventDefault(),u())};return(0,c.useEffect)(()=>{let e=e=>{i.current&&!i.current.contains(e.target)&&l()};return window.addEventListener("click",e),()=>{window.removeEventListener("click",e)}},[l]),(0,c.useEffect)(()=>{d.current&&d.current.focus()},[]),(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onKeyDown:m,children:(0,s.jsxs)("div",{ref:i,className:"dark:border-netural-400 inline-block max-h-[400px] transform overflow-hidden overflow-y-auto rounded-lg border border-gray-300 bg-white px-4 pt-5 pb-4 text-left align-bottom shadow-xl transition-all dark:bg-[#202123] sm:my-8 sm:max-h-[600px] sm:w-full sm:max-w-lg sm:p-6 sm:align-middle",role:"dialog",children:[(0,s.jsx)("div",{className:"mb-4 text-xl font-bold text-black dark:text-neutral-200",children:t.name}),(0,s.jsx)("div",{className:"mb-4 text-sm italic text-black dark:text-neutral-200",children:t.description}),n.map((e,t)=>(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("div",{className:"mb-2 text-sm font-bold text-neutral-200",children:e.key}),(0,s.jsx)("textarea",{ref:0===t?d:void 0,className:"mt-1 w-full rounded-lg border border-neutral-500 px-4 py-2 text-neutral-900 shadow focus:outline-none dark:border-neutral-800 dark:border-opacity-50 dark:bg-[#40414F] dark:text-neutral-100",style:{resize:"none"},placeholder:"Enter a value for ".concat(e.key,"..."),value:e.value,onChange:e=>x(t,e.target.value),rows:3})]},t)),(0,s.jsx)("button",{className:"mt-6 w-full rounded-lg border border-neutral-500 px-4 py-2 text-neutral-900 shadow hover:bg-neutral-100 focus:outline-none dark:border-neutral-800 dark:border-opacity-50 dark:bg-white dark:text-black dark:hover:bg-neutral-300",onClick:u,children:"Submit"})]})})},f=e=>{var t;let{messageIsStreaming:r,model:a,conversationIsEmpty:l,messages:n,prompts:o,onSend:i,onRegenerate:x,stopConversationRef:f,textareaRef:v}=e,{t:b}=(0,d.$G)("chat"),[w,j]=(0,c.useState)(),[y,k]=(0,c.useState)(!1),[N,C]=(0,c.useState)(!1),[S,I]=(0,c.useState)(0),[z,D]=(0,c.useState)(""),[P,E]=(0,c.useState)([]),[Z,L]=(0,c.useState)(!1),T=(0,c.useRef)(null),O=o.filter(e=>e.name.toLowerCase().includes(z.toLowerCase())),_=e=>{let t=e.target.value,r=a.maxLength;if(t.length>r){alert(b("Message limit is {{maxLength}} characters. You have entered {{valueLength}} characters.",{maxLength:r,valueLength:t.length}));return}j(t),K(t)},A=()=>{if(!r){if(!w){alert(b("Please enter a message"));return}i({role:"user",content:w}),j(""),window.innerWidth<640&&v&&v.current&&v.current.blur()}},U=()=>{f.current=!0,setTimeout(()=>{f.current=!1},1e3)},F=()=>{let e=void 0===window.navigator?"":navigator.userAgent;return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(e)},R=()=>{let e=O[S];e&&(j(t=>{let r=null==t?void 0:t.replace(/\/\w*$/,e.content);return r}),J(e)),C(!1)},G=e=>{N?"ArrowDown"===e.key?(e.preventDefault(),I(e=>e<o.length-1?e+1:e)):"ArrowUp"===e.key?(e.preventDefault(),I(e=>e>0?e-1:e)):"Tab"===e.key?(e.preventDefault(),I(e=>e<o.length-1?e+1:0)):"Enter"===e.key?(e.preventDefault(),R()):"Escape"===e.key?(e.preventDefault(),C(!1)):I(0):"Enter"!==e.key||y||F()||e.shiftKey||(e.preventDefault(),A())},M=e=>{let t;let r=/{{(.*?)}}/g,a=[];for(;null!==(t=r.exec(e));)a.push(t[1]);return a},K=(0,c.useCallback)(e=>{let t=e.match(/\/\w*$/);t?(C(!0),D(t[0].slice(1))):(C(!1),D(""))},[]),J=e=>{let t=M(e.content);E(t),t.length>0?L(!0):(j(t=>{let r=null==t?void 0:t.replace(/\/\w*$/,e.content);return r}),K(e.content))},$=e=>{let t=null==w?void 0:w.replace(/{{(.*?)}}/g,(t,r)=>{let a=P.indexOf(r);return e[a]});j(t),v&&v.current&&v.current.focus()};return(0,c.useEffect)(()=>{T.current&&(T.current.scrollTop=30*S)},[S]),(0,c.useEffect)(()=>{if(v&&v.current){var e,t;v.current.style.height="inherit",v.current.style.height="".concat(null===(e=v.current)||void 0===e?void 0:e.scrollHeight,"px"),v.current.style.overflow="".concat((null==v?void 0:null===(t=v.current)||void 0===t?void 0:t.scrollHeight)>400?"auto":"hidden")}},[w]),(0,c.useEffect)(()=>{let e=e=>{T.current&&!T.current.contains(e.target)&&C(!1)};return window.addEventListener("click",e),()=>{window.removeEventListener("click",e)}},[]),(0,s.jsxs)("div",{className:"absolute bottom-0 left-0 w-full border-transparent bg-gradient-to-b from-transparent via-white to-white pt-6 dark:border-white/20 dark:via-[#343541] dark:to-[#343541] md:pt-2",children:[(0,s.jsxs)("div",{className:"stretch mx-2 mt-4 flex flex-row gap-3 last:mb-2 md:mx-4 md:mt-[52px] md:last:mb-6 lg:mx-auto lg:max-w-3xl",children:[r&&(0,s.jsxs)("button",{className:"absolute left-0 right-0 mx-auto mt-2 flex w-fit items-center gap-3 rounded border border-neutral-200 bg-white py-2 px-4 text-black hover:opacity-50 dark:border-neutral-600 dark:bg-[#343541] dark:text-white md:top-0",onClick:U,children:[(0,s.jsx)(u.Z,{size:16})," ",b("Stop Generating")]}),!r&&!l&&(0,s.jsxs)("button",{className:"absolute left-0 right-0 mx-auto mt-2 flex w-fit items-center gap-3 rounded border border-neutral-200 bg-white py-2 px-4 text-black hover:opacity-50 dark:border-neutral-600 dark:bg-[#343541] dark:text-white md:top-0",onClick:x,children:[(0,s.jsx)(m.Z,{size:16})," ",b("Regenerate response")]}),(0,s.jsxs)("div",{className:"relative mx-2 flex w-full flex-grow flex-col rounded-md border border-black/10 bg-white shadow-[0_0_10px_rgba(0,0,0,0.10)] dark:border-gray-900/50 dark:bg-[#40414F] dark:text-white dark:shadow-[0_0_15px_rgba(0,0,0,0.10)] sm:mx-4",children:[(0,s.jsx)("textarea",{ref:v,className:"m-0 w-full resize-none border-0 bg-transparent p-0 py-2 pr-8 pl-2 text-black dark:bg-transparent dark:text-white md:py-3 md:pl-4",style:{resize:"none",bottom:"".concat(null==v?void 0:null===(t=v.current)||void 0===t?void 0:t.scrollHeight,"px"),maxHeight:"400px",overflow:"".concat(v.current&&v.current.scrollHeight>400?"auto":"hidden")},placeholder:b('Type a message or type "/" to select a prompt...')||"",value:w,rows:1,onCompositionStart:()=>k(!0),onCompositionEnd:()=>k(!1),onChange:_,onKeyDown:G}),(0,s.jsx)("button",{className:"absolute right-2 top-2 rounded-sm p-1 text-neutral-800 opacity-60 hover:bg-neutral-200 hover:text-neutral-900 dark:bg-opacity-50 dark:text-neutral-100 dark:hover:text-neutral-200",onClick:A,children:(0,s.jsx)(p.Z,{size:18})}),N&&o.length>0&&(0,s.jsx)("div",{className:"absolute bottom-12 w-full",children:(0,s.jsx)(h,{activePromptIndex:S,prompts:O,onSelect:R,onMouseOver:I,promptListRef:T})}),Z&&(0,s.jsx)(g,{prompt:o[S],variables:P,onSubmit:$,onClose:()=>L(!1)})]})]}),(0,s.jsxs)("div",{className:"px-3 pt-2 pb-3 text-center text-[12px] text-black/50 dark:text-white/50 md:px-4 md:pt-3 md:pb-6",children:[(0,s.jsx)("a",{href:"https://github.com/mckaywrigley/chatbot-ui",target:"_blank",rel:"noreferrer",className:"underline",children:"ChatBot UI"}),"."," ",b("Chatbot UI is an advanced chatbot kit for OpenAI's chat models aiming to mimic ChatGPT's interface and functionality.")]})]})};var v=r(10614);let b=()=>(0,s.jsx)("div",{className:"group border-b border-black/10 bg-gray-50 text-gray-800 dark:border-gray-900/50 dark:bg-[#444654] dark:text-gray-100",style:{overflowWrap:"anywhere"},children:(0,s.jsxs)("div",{className:"m-auto flex gap-4 p-4 text-base md:max-w-2xl md:gap-6 md:py-6 lg:max-w-2xl lg:px-0 xl:max-w-3xl",children:[(0,s.jsx)("div",{className:"min-w-[40px] font-bold",children:"AI:"}),(0,s.jsx)(v.Z,{className:"animate-pulse"})]})});var w=r(21942),j=r(88198),y=r(93625),k=r(45884),N=r(29758),C=r(30399);let S={javascript:".js",python:".py",java:".java",c:".c",cpp:".cpp","c++":".cpp","c#":".cs",ruby:".rb",php:".php",swift:".swift","objective-c":".m",kotlin:".kt",typescript:".ts",go:".go",perl:".pl",rust:".rs",scala:".scala",haskell:".hs",lua:".lua",shell:".sh",sql:".sql",html:".html",css:".css"},I=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r="ABCDEFGHJKLMNPQRSTUVWXY3456789",a="";for(let t=0;t<e;t++)a+=r.charAt(Math.floor(Math.random()*r.length));return t?a.toLowerCase():a};var z=r(67828),D=r(80335),P=r(93179),E=r(84283);let Z=(0,c.memo)(e=>{let{language:t,value:r}=e,{t:a}=(0,d.$G)("markdown"),[l,n]=(0,c.useState)(!1),o=()=>{navigator.clipboard&&navigator.clipboard.writeText&&navigator.clipboard.writeText(r).then(()=>{n(!0),setTimeout(()=>{n(!1)},2e3)})},i=()=>{let e=S[t]||".file",l="file-".concat(I(3,!0)).concat(e),s=window.prompt(a("Enter file name")||"",l);if(!s)return;let n=new Blob([r],{type:"text/plain"}),o=URL.createObjectURL(n),i=document.createElement("a");i.download=s,i.href=o,i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(o)};return(0,s.jsxs)("div",{className:"codeblock relative font-sans text-[16px]",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between py-1.5 px-4",children:[(0,s.jsx)("span",{className:"text-xs lowercase text-white",children:t}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("button",{className:"flex gap-1.5 items-center rounded bg-none p-1 text-xs text-white",onClick:o,children:[l?(0,s.jsx)(j.Z,{size:18}):(0,s.jsx)(z.Z,{size:18}),l?a("Copied!"):a("Copy code")]}),(0,s.jsx)("button",{className:"flex items-center rounded bg-none p-1 text-xs text-white",onClick:i,children:(0,s.jsx)(D.Z,{size:18})})]})]}),(0,s.jsx)(P.Z,{language:t,style:E.vk,customStyle:{margin:0},children:r})]})});Z.displayName="CodeBlock";var L=r(16202);let T=(0,c.memo)(L.D),O=(0,c.memo)(e=>{let{message:t,messageIndex:r,onEditMessage:a}=e,{t:l}=(0,d.$G)("chat"),[n,o]=(0,c.useState)(!1),[i,x]=(0,c.useState)(!1),[u,m]=(0,c.useState)(t.content),[p,h]=(0,c.useState)(!1),g=(0,c.useRef)(null),f=()=>{o(!n)},v=e=>{m(e.target.value),g.current&&(g.current.style.height="inherit",g.current.style.height="".concat(g.current.scrollHeight,"px"))},b=()=>{t.content!=u&&a({...t,content:u},r),o(!1)},S=e=>{"Enter"!==e.key||i||e.shiftKey||(e.preventDefault(),b())},I=()=>{navigator.clipboard&&navigator.clipboard.writeText(t.content).then(()=>{h(!0),setTimeout(()=>{h(!1)},2e3)})};return(0,c.useEffect)(()=>{g.current&&(g.current.style.height="inherit",g.current.style.height="".concat(g.current.scrollHeight,"px"))},[n]),(0,s.jsx)("div",{className:"group px-4 ".concat("assistant"===t.role?"border-b border-black/10 bg-gray-50 text-gray-800 dark:border-gray-900/50 dark:bg-[#444654] dark:text-gray-100":"border-b border-black/10 bg-white text-gray-800 dark:border-gray-900/50 dark:bg-[#343541] dark:text-gray-100"),style:{overflowWrap:"anywhere"},children:(0,s.jsxs)("div",{className:"relative m-auto flex gap-4 p-4 text-base md:max-w-2xl md:gap-6 md:py-6 lg:max-w-2xl lg:px-0 xl:max-w-3xl",children:[(0,s.jsxs)("div",{className:"min-w-[40px] text-right font-bold",children:[l("assistant"===t.role?"AI":"You"),":"]}),(0,s.jsx)("div",{className:"prose mt-[-2px] w-full dark:prose-invert",children:"user"===t.role?(0,s.jsxs)("div",{className:"flex w-full",children:[n?(0,s.jsxs)("div",{className:"flex w-full flex-col",children:[(0,s.jsx)("textarea",{ref:g,className:"w-full resize-none whitespace-pre-wrap border-none dark:bg-[#343541]",value:u,onChange:v,onKeyDown:S,onCompositionStart:()=>x(!0),onCompositionEnd:()=>x(!1),style:{fontFamily:"inherit",fontSize:"inherit",lineHeight:"inherit",padding:"0",margin:"0",overflow:"hidden"}}),(0,s.jsxs)("div",{className:"mt-10 flex justify-center space-x-4",children:[(0,s.jsx)("button",{className:"h-[40px] rounded-md bg-blue-500 px-4 py-1 text-sm font-medium text-white enabled:hover:bg-blue-600 disabled:opacity-50",onClick:b,disabled:u.trim().length<=0,children:l("Save & Submit")}),(0,s.jsx)("button",{className:"h-[40px] rounded-md border border-neutral-300 px-4 py-1 text-sm font-medium text-neutral-700 hover:bg-neutral-100 dark:border-neutral-700 dark:text-neutral-300 dark:hover:bg-neutral-800",onClick:()=>{m(t.content),o(!1)},children:l("Cancel")})]})]}):(0,s.jsx)("div",{className:"prose whitespace-pre-wrap dark:prose-invert",children:t.content}),(window.innerWidth<640||!n)&&(0,s.jsx)("button",{className:"absolute translate-x-[1000px] text-gray-500 hover:text-gray-700 focus:translate-x-0 group-hover:translate-x-0 dark:text-gray-400 dark:hover:text-gray-300 ".concat(window.innerWidth<640?"right-3 bottom-1":"right-0 top-[26px]","\n                    "),onClick:f,children:(0,s.jsx)(w.Z,{size:20})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"absolute ".concat(window.innerWidth<640?"right-3 bottom-1":"right-0 top-[26px] m-0"),children:p?(0,s.jsx)(j.Z,{size:20,className:"text-green-500 dark:text-green-400"}):(0,s.jsx)("button",{className:"translate-x-[1000px] text-gray-500 hover:text-gray-700 focus:translate-x-0 group-hover:translate-x-0 dark:text-gray-400 dark:hover:text-gray-300",onClick:I,children:(0,s.jsx)(y.Z,{size:20})})}),(0,s.jsx)(T,{className:"prose dark:prose-invert",remarkPlugins:[N.Z,C.Z],rehypePlugins:[k.Z],components:{code(e){let{node:t,inline:r,className:a,children:l,...n}=e,o=/language-(\w+)/.exec(a||"");return!r&&o?(0,s.jsx)(Z,{language:o[1],value:String(l).replace(/\n$/,""),...n},Math.random()):(0,s.jsx)("code",{className:a,...n,children:l})},table(e){let{children:t}=e;return(0,s.jsx)("table",{className:"border-collapse border border-black py-1 px-3 dark:border-white",children:t})},th(e){let{children:t}=e;return(0,s.jsx)("th",{className:"break-words border border-black bg-gray-500 py-1 px-3 text-white dark:border-white",children:t})},td(e){let{children:t}=e;return(0,s.jsx)("td",{className:"break-words border border-black py-1 px-3 dark:border-white",children:t})}},children:t.content})]})})]})})});O.displayName="ChatMessage";var _=r(58403);let A=e=>{let{error:t}=e;return(0,s.jsxs)("div",{className:"mx-6 flex h-full flex-col items-center justify-center text-red-500",children:[(0,s.jsx)("div",{className:"mb-5",children:(0,s.jsx)(_.Z,{size:36})}),(0,s.jsx)("div",{className:"mb-3 text-2xl font-medium",children:t.title}),t.messageLines.map((e,t)=>(0,s.jsxs)("div",{className:"text-center",children:[" ",e," "]},t)),(0,s.jsx)("div",{className:"mt-4 text-xs opacity-50 dark:text-red-400",children:t.code?(0,s.jsxs)("i",{children:["Code: ",t.code]}):""})]})};var U=r(93844);let F=e=>{let{model:t,models:r,defaultModelId:a,onModelChange:l}=e,{t:n}=(0,d.$G)("chat");return(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"mb-2 text-left text-neutral-700 dark:text-neutral-400",children:n("Model")}),(0,s.jsx)("div",{className:"w-full rounded-lg border border-neutral-200 bg-transparent pr-2 text-neutral-900 dark:border-neutral-600 dark:text-white",children:(0,s.jsx)("select",{className:"w-full bg-transparent p-2",placeholder:n("Select a model")||"",value:(null==t?void 0:t.id)||a,onChange:e=>{l(r.find(t=>t.id===e.target.value))},children:r.map(e=>(0,s.jsx)("option",{value:e.id,className:"dark:bg-[#343541] dark:text-white",children:e.id===a?"Default (".concat(e.name,")"):e.name},e.id))})}),(0,s.jsx)("div",{className:"w-full mt-3 text-left text-neutral-700 dark:text-neutral-400 flex items-center",children:(0,s.jsxs)("a",{href:"https://platform.openai.com/account/usage",target:"_blank",className:"flex items-center",children:[(0,s.jsx)(U.Z,{size:18,className:"inline mr-1"}),n("View Account Usage")]})})]})};var R=r(83454);let G=R.env.DEFAULT_SYSTEM_PROMPT||"You are ChatGPT, a large language model trained by OpenAI. Follow the user's instructions carefully. Respond using markdown.";R.env.OPENAI_API_HOST;let M=e=>{var t;let{conversation:r,prompts:a,onChangePrompt:l}=e,{t:n}=(0,d.$G)("chat"),[o,i]=(0,c.useState)(""),[x,u]=(0,c.useState)(0),[m,p]=(0,c.useState)(!1),[f,v]=(0,c.useState)(""),[b,w]=(0,c.useState)([]),[j,y]=(0,c.useState)(!1),k=(0,c.useRef)(null),N=(0,c.useRef)(null),C=a.filter(e=>e.name.toLowerCase().includes(f.toLowerCase())),S=e=>{let t=e.target.value,a=r.model.maxLength;if(t.length>a){alert(n("Prompt limit is {{maxLength}} characters. You have entered {{valueLength}} characters.",{maxLength:a,valueLength:t.length}));return}i(t),D(t),t.length>0&&l(t)},I=()=>{let e=C[x];i(t=>{let r=null==t?void 0:t.replace(/\/\w*$/,e.content);return r}),P(e),p(!1)},z=e=>{let t;let r=/{{(.*?)}}/g,a=[];for(;null!==(t=r.exec(e));)a.push(t[1]);return a},D=(0,c.useCallback)(e=>{let t=e.match(/\/\w*$/);t?(p(!0),v(t[0].slice(1))):(p(!1),v(""))},[]),P=e=>{let t=z(e.content);if(w(t),t.length>0)y(!0);else{let t=null==o?void 0:o.replace(/\/\w*$/,e.content);i(t),l(t),D(e.content)}},E=e=>{let t=null==o?void 0:o.replace(/{{(.*?)}}/g,(t,r)=>{let a=b.indexOf(r);return e[a]});i(t),l(t),k&&k.current&&k.current.focus()},Z=e=>{m&&("ArrowDown"===e.key?(e.preventDefault(),u(e=>e<a.length-1?e+1:e)):"ArrowUp"===e.key?(e.preventDefault(),u(e=>e>0?e-1:e)):"Tab"===e.key?(e.preventDefault(),u(e=>e<a.length-1?e+1:0)):"Enter"===e.key?(e.preventDefault(),I()):"Escape"===e.key?(e.preventDefault(),p(!1)):u(0))};return(0,c.useEffect)(()=>{if(k&&k.current){var e;k.current.style.height="inherit",k.current.style.height="".concat(null===(e=k.current)||void 0===e?void 0:e.scrollHeight,"px")}},[o]),(0,c.useEffect)(()=>{r.prompt?i(r.prompt):i(G)},[r]),(0,c.useEffect)(()=>{let e=e=>{N.current&&!N.current.contains(e.target)&&p(!1)};return window.addEventListener("click",e),()=>{window.removeEventListener("click",e)}},[]),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{className:"mb-2 text-left text-neutral-700 dark:text-neutral-400",children:n("System Prompt")}),(0,s.jsx)("textarea",{ref:k,className:"w-full rounded-lg border border-neutral-200 bg-transparent px-4 py-3 text-neutral-900 dark:border-neutral-600 dark:text-neutral-100",style:{resize:"none",bottom:"".concat(null==k?void 0:null===(t=k.current)||void 0===t?void 0:t.scrollHeight,"px"),maxHeight:"300px",overflow:"".concat(k.current&&k.current.scrollHeight>400?"auto":"hidden")},placeholder:n('Enter a prompt or type "/" to select a prompt...')||"",value:n(o)||"",rows:1,onChange:S,onKeyDown:Z}),m&&a.length>0&&(0,s.jsx)("div",{children:(0,s.jsx)(h,{activePromptIndex:x,prompts:C,onSelect:I,onMouseOver:u,promptListRef:N})}),j&&(0,s.jsx)(g,{prompt:a[x],variables:b,onSubmit:E,onClose:()=>y(!1)})]})},K=(0,c.memo)(e=>{let t,r,{conversation:a,models:l,apiKey:u,serverSideApiKeyIsSet:m,defaultModelId:p,messageIsStreaming:h,modelError:g,loading:v,prompts:w,onSend:j,onUpdateConversation:y,onEditMessage:k,stopConversationRef:N}=e,{t:C}=(0,d.$G)("chat"),[S,I]=(0,c.useState)(),[z,D]=(0,c.useState)(!0),[P,E]=(0,c.useState)(!1),[Z,L]=(0,c.useState)(!1),T=(0,c.useRef)(null),_=(0,c.useRef)(null),U=(0,c.useRef)(null);(0,c.useCallback)(()=>{if(z){var e,t;null===(e=T.current)||void 0===e||e.scrollIntoView({behavior:"smooth"}),null===(t=U.current)||void 0===t||t.focus()}},[z]);let R=()=>{if(_.current){let{scrollTop:e,scrollHeight:t,clientHeight:r}=_.current;e+r<t-30?(D(!1),L(!0)):(D(!0),L(!1))}},G=()=>{var e;null===(e=_.current)||void 0===e||e.scrollTo({top:_.current.scrollHeight,behavior:"smooth"})},K=()=>{E(!P)},J=()=>{confirm(C("Are you sure you want to clear all messages?"))&&y(a,{key:"messages",value:[]})},$=()=>{if(z){var e;null===(e=T.current)||void 0===e||e.scrollIntoView(!0)}},H=function(){for(var e=arguments.length,a=Array(e),l=0;l<e;l++)a[l]=arguments[l];r?(clearTimeout(t),t=setTimeout(()=>{Date.now()-r>=250&&($(...a),r=Date.now())},250-(Date.now()-r))):($(...a),r=Date.now())};return(0,c.useEffect)(()=>{H(),I(a.messages[a.messages.length-2])},[a.messages,H]),(0,c.useEffect)(()=>{let e=new IntersectionObserver(e=>{let[t]=e;if(D(t.isIntersecting),t.isIntersecting){var r;null===(r=U.current)||void 0===r||r.focus()}},{root:null,threshold:.5}),t=T.current;return t&&e.observe(t),()=>{t&&e.unobserve(t)}},[T]),(0,s.jsxs)("div",{className:"relative flex-1 overflow-hidden bg-white dark:bg-[#343541]",children:[u||m?g?(0,s.jsx)(A,{error:g}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"max-h-full overflow-x-hidden",ref:_,onScroll:R,children:0===a.messages.length?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"mx-auto flex w-[350px] flex-col space-y-10 pt-12 sm:w-[600px]",children:[(0,s.jsx)("div",{className:"text-center text-3xl font-semibold text-gray-800 dark:text-gray-100",children:0===l.length?(0,s.jsx)("div",{children:(0,s.jsx)(x,{size:"16px",className:"mx-auto"})}):"Chatbot UI"}),l.length>0&&(0,s.jsxs)("div",{className:"flex h-full flex-col space-y-4 rounded-lg border border-neutral-200 p-4 dark:border-neutral-600",children:[(0,s.jsx)(F,{model:a.model,models:l,defaultModelId:p,onModelChange:e=>y(a,{key:"model",value:e})}),(0,s.jsx)(M,{conversation:a,prompts:w,onChangePrompt:e=>y(a,{key:"prompt",value:e})})]})]})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex justify-center border border-b-neutral-300 bg-neutral-100 py-2 text-sm text-neutral-500 dark:border-none dark:bg-[#444654] dark:text-neutral-200",children:[C("Model"),": ",a.model.name,(0,s.jsx)("button",{className:"ml-2 cursor-pointer hover:opacity-50",onClick:K,children:(0,s.jsx)(n.Z,{size:18})}),(0,s.jsx)("button",{className:"ml-2 cursor-pointer hover:opacity-50",onClick:J,children:(0,s.jsx)(o.Z,{size:18})})]}),P&&(0,s.jsx)("div",{className:"flex flex-col space-y-10 md:mx-auto md:max-w-xl md:gap-6 md:py-3 md:pt-6 lg:max-w-2xl lg:px-0 xl:max-w-3xl",children:(0,s.jsx)("div",{className:"flex h-full flex-col space-y-4 border-b border-neutral-200 p-4 dark:border-neutral-600 md:rounded-lg md:border",children:(0,s.jsx)(F,{model:a.model,models:l,defaultModelId:p,onModelChange:e=>y(a,{key:"model",value:e})})})}),a.messages.map((e,t)=>(0,s.jsx)(O,{message:e,messageIndex:t,onEditMessage:k},t)),v&&(0,s.jsx)(b,{}),(0,s.jsx)("div",{className:"h-[162px] bg-white dark:bg-[#343541]",ref:T})]})}),(0,s.jsx)(f,{stopConversationRef:N,textareaRef:U,messageIsStreaming:h,conversationIsEmpty:0===a.messages.length,messages:a.messages,model:a.model,prompts:w,onSend:e=>{I(e),j(e)},onRegenerate:()=>{S&&j(S,2)}})]}):(0,s.jsxs)("div",{className:"mx-auto flex h-full w-[300px] flex-col justify-center space-y-6 sm:w-[600px]",children:[(0,s.jsx)("div",{className:"text-center text-4xl font-bold text-black dark:text-white",children:"Welcome to Chatbot UI"}),(0,s.jsxs)("div",{className:"text-center text-lg text-black dark:text-white",children:[(0,s.jsx)("div",{className:"mb-8",children:"Chatbot UI is an open source clone of OpenAI's ChatGPT UI."}),(0,s.jsx)("div",{className:"mb-2 font-bold",children:"Important: Chatbot UI is 100% unaffiliated with OpenAI."})]}),(0,s.jsxs)("div",{className:"text-center text-gray-500 dark:text-gray-400",children:[(0,s.jsx)("div",{className:"mb-2",children:"Chatbot UI allows you to plug in your API key to use this UI with their API."}),(0,s.jsxs)("div",{className:"mb-2",children:["It is ",(0,s.jsx)("span",{className:"italic",children:"only"})," used to communicate with their API."]}),(0,s.jsx)("div",{className:"mb-2",children:C("Please set your OpenAI API key in the bottom left of the sidebar.")}),(0,s.jsxs)("div",{children:[C("If you don't have an OpenAI API key, you can get one here: "),(0,s.jsx)("a",{href:"https://platform.openai.com/account/api-keys",target:"_blank",rel:"noreferrer",className:"text-blue-500 hover:underline",children:"openai.com"})]})]})]}),Z&&(0,s.jsx)("div",{className:"absolute bottom-0 right-0 mb-4 mr-4 pb-20",children:(0,s.jsx)("button",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-neutral-200 text-gray-700 shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700",onClick:G,children:(0,s.jsx)(i.Z,{size:18})})})]})});K.displayName="Chat";var J=r(1177),$=r(16745),H=r(89014),W=r(55814),B=r(87664),Y=r(62577),V=r(97283),q=r(30471),X=r(74075),Q=r(47447);let ee=e=>{let{selectedConversation:t,conversation:r,loading:a,onSelectConversation:l,onDeleteConversation:n,onUpdateConversation:o}=e,[i,d]=(0,c.useState)(!1),[x,u]=(0,c.useState)(!1),[m,p]=(0,c.useState)(""),h=e=>{"Enter"===e.key&&(e.preventDefault(),f(t))},g=(e,t)=>{e.dataTransfer&&e.dataTransfer.setData("conversation",JSON.stringify(t))},f=e=>{m.trim().length>0&&(o(e,{key:"name",value:m}),p(""),u(!1))};return(0,c.useEffect)(()=>{x?d(!1):i&&u(!1)},[x,i]),(0,s.jsxs)("div",{className:"relative flex items-center",children:[x&&t.id===r.id?(0,s.jsxs)("div",{className:"flex w-full items-center gap-3 bg-[#343541]/90 p-3 rounded-lg",children:[(0,s.jsx)(Q.Z,{size:18}),(0,s.jsx)("input",{className:"mr-12 flex-1 overflow-hidden overflow-ellipsis border-neutral-400 bg-transparent text-left text-[12.5px] leading-3 text-white outline-none focus:border-neutral-100",type:"text",value:m,onChange:e=>p(e.target.value),onKeyDown:h,autoFocus:!0})]}):(0,s.jsxs)("button",{className:"flex w-full cursor-pointer items-center gap-3 rounded-lg p-3 text-sm transition-colors duration-200 hover:bg-[#343541]/90 ".concat(a?"disabled:cursor-not-allowed":""," ").concat(t.id===r.id?"bg-[#343541]/90":""),onClick:()=>l(r),disabled:a,draggable:"true",onDragStart:e=>g(e,r),children:[(0,s.jsx)(Q.Z,{size:18}),(0,s.jsx)("div",{className:"relative max-h-5 flex-1 overflow-hidden text-ellipsis whitespace-nowrap break-all text-left text-[12.5px] leading-3 ".concat(t.id===r.id?"pr-12":"pr-1"),children:r.name})]}),(i||x)&&t.id===r.id&&(0,s.jsxs)("div",{className:"absolute right-1 z-10 flex text-gray-300",children:[(0,s.jsx)("button",{className:"min-w-[20px] p-1 text-neutral-400 hover:text-neutral-100",onClick:e=>{e.stopPropagation(),i?n(r):x&&f(r),d(!1),u(!1)},children:(0,s.jsx)(j.Z,{size:18})}),(0,s.jsx)("button",{className:"min-w-[20px] p-1 text-neutral-400 hover:text-neutral-100",onClick:e=>{e.stopPropagation(),d(!1),u(!1)},children:(0,s.jsx)(V.Z,{size:18})})]}),t.id===r.id&&!i&&!x&&(0,s.jsxs)("div",{className:"absolute right-1 z-10 flex text-gray-300",children:[(0,s.jsx)("button",{className:"min-w-[20px] p-1 text-neutral-400 hover:text-neutral-100",onClick:e=>{e.stopPropagation(),u(!0),p(t.name)},children:(0,s.jsx)(q.Z,{size:18})}),(0,s.jsx)("button",{className:"min-w-[20px] p-1 text-neutral-400 hover:text-neutral-100",onClick:e=>{e.stopPropagation(),d(!0)},children:(0,s.jsx)(X.Z,{size:18})})]})]})},et=e=>{let{searchTerm:t,conversations:r,currentFolder:a,onDeleteFolder:l,onUpdateFolder:n,selectedConversation:o,loading:i,onSelectConversation:d,onDeleteConversation:x,onUpdateConversation:u}=e,[m,p]=(0,c.useState)(!1),[h,g]=(0,c.useState)(!1),[f,v]=(0,c.useState)(""),[b,w]=(0,c.useState)(!1),y=e=>{"Enter"===e.key&&(e.preventDefault(),k())},k=()=>{n(a.id,f),v(""),g(!1)},N=(e,t)=>{if(e.dataTransfer){w(!0);let r=JSON.parse(e.dataTransfer.getData("conversation"));u(r,{key:"folderId",value:t.id}),e.target.style.background="none"}},C=e=>{e.preventDefault()},S=e=>{e.target.style.background="#343541"},I=e=>{e.target.style.background="none"};return(0,c.useEffect)(()=>{h?p(!1):m&&g(!1)},[h,m]),(0,c.useEffect)(()=>{t?w(!0):w(!1)},[t]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"relative flex items-center",children:[h?(0,s.jsxs)("div",{className:"flex w-full items-center gap-3 bg-[#343541]/90 p-3 rounded-lg",children:[b?(0,s.jsx)(B.Z,{size:18}):(0,s.jsx)(Y.Z,{size:18}),(0,s.jsx)("input",{className:"mr-12 flex-1 overflow-hidden overflow-ellipsis border-neutral-400 bg-transparent text-left text-[12.5px] leading-3 text-white outline-none focus:border-neutral-100",type:"text",value:f,onChange:e=>v(e.target.value),onKeyDown:y,autoFocus:!0})]}):(0,s.jsxs)("button",{className:"flex w-full cursor-pointer items-center gap-3 rounded-lg p-3 text-sm transition-colors duration-200 hover:bg-[#343541]/90",onClick:()=>w(!b),onDrop:e=>N(e,a),onDragOver:C,onDragEnter:S,onDragLeave:I,children:[b?(0,s.jsx)(B.Z,{size:18}):(0,s.jsx)(Y.Z,{size:18}),(0,s.jsx)("div",{className:"relative max-h-5 flex-1 overflow-hidden text-ellipsis whitespace-nowrap break-all text-left text-[12.5px] leading-3",children:a.name})]}),(m||h)&&(0,s.jsxs)("div",{className:"absolute right-1 z-10 flex text-gray-300",children:[(0,s.jsx)("button",{className:"min-w-[20px] p-1 text-neutral-400 hover:text-neutral-100",onClick:e=>{e.stopPropagation(),m?l(a.id):h&&k(),p(!1),g(!1)},children:(0,s.jsx)(j.Z,{size:18})}),(0,s.jsx)("button",{className:"min-w-[20px] p-1 text-neutral-400 hover:text-neutral-100",onClick:e=>{e.stopPropagation(),p(!1),g(!1)},children:(0,s.jsx)(V.Z,{size:18})})]}),!m&&!h&&(0,s.jsxs)("div",{className:"absolute right-1 z-10 flex text-gray-300",children:[(0,s.jsx)("button",{className:"min-w-[20px] p-1 text-neutral-400 hover:text-neutral-100",onClick:e=>{e.stopPropagation(),g(!0),v(a.name)},children:(0,s.jsx)(q.Z,{size:18})}),(0,s.jsx)("button",{className:"min-w-[20px] p-1 text-neutral-400 hover:text-neutral-100",onClick:e=>{e.stopPropagation(),p(!0)},children:(0,s.jsx)(X.Z,{size:18})})]})]}),b?r.map((e,t)=>{if(e.folderId===a.id)return(0,s.jsx)("div",{className:"ml-5 gap-2 border-l pl-2",children:(0,s.jsx)(ee,{selectedConversation:o,conversation:e,loading:i,onSelectConversation:d,onDeleteConversation:x,onUpdateConversation:u})},t)}):null]})},er=e=>{let{searchTerm:t,conversations:r,folders:a,onDeleteFolder:l,onUpdateFolder:n,selectedConversation:o,loading:i,onSelectConversation:d,onDeleteConversation:c,onUpdateConversation:x}=e;return(0,s.jsx)("div",{className:"flex w-full flex-col pt-2",children:a.map((e,a)=>(0,s.jsx)(et,{searchTerm:t,conversations:r.filter(e=>e.folderId),currentFolder:e,onDeleteFolder:l,onUpdateFolder:n,selectedConversation:o,loading:i,onSelectConversation:d,onDeleteConversation:c,onUpdateConversation:x},a))})},ea=e=>{let{placeholder:t,searchTerm:r,onSearch:a}=e,{t:l}=(0,d.$G)("sidebar"),n=e=>{a(e.target.value)},o=()=>{a("")};return(0,s.jsxs)("div",{className:"relative flex items-center",children:[(0,s.jsx)("input",{className:"w-full flex-1 rounded-md border border-neutral-600 bg-[#202123] px-4 py-3 pr-10 text-[14px] leading-3 text-white",type:"text",placeholder:l(t)||"",value:r,onChange:n}),r&&(0,s.jsx)(V.Z,{className:"absolute right-4 cursor-pointer text-neutral-300 hover:text-neutral-400",size:18,onClick:o})]})};var el=r(75846),es=r(51047),en=r(64738),eo=r(52216);let ei=e=>{let{text:t,icon:r,onClick:a}=e;return(0,s.jsxs)("button",{className:"flex w-full cursor-pointer select-none items-center gap-3 rounded-md py-3 px-3 text-[14px] leading-3 text-white transition-colors duration-200 hover:bg-gray-500/10",onClick:a,children:[(0,s.jsx)("div",{children:r}),(0,s.jsx)("span",{children:t})]})},ed=e=>{let{onImport:t}=e,{t:r}=(0,d.$G)("sidebar");return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{id:"import-file",className:"sr-only",tabIndex:-1,type:"file",accept:".json",onChange:e=>{var r;if(!(null===(r=e.target.files)||void 0===r?void 0:r.length))return;let a=e.target.files[0],l=new FileReader;l.onload=e=>{var r;t(JSON.parse(null===(r=e.target)||void 0===r?void 0:r.result))},l.readAsText(a)}}),(0,s.jsx)(ei,{text:r("Import conversations"),icon:(0,s.jsx)(eo.Z,{size:18}),onClick:()=>{let e=document.querySelector("#import-file");e&&e.click()}})]})};var ec=r(35336);let ex=e=>{let{apiKey:t,onApiKeyChange:r}=e,{t:a}=(0,d.$G)("sidebar"),[l,n]=(0,c.useState)(!1),[o,i]=(0,c.useState)(t),x=(0,c.useRef)(null),u=e=>{"Enter"===e.key&&(e.preventDefault(),m(o))},m=e=>{r(e.trim()),n(!1)};return(0,c.useEffect)(()=>{if(l){var e;null===(e=x.current)||void 0===e||e.focus()}},[l]),l?(0,s.jsxs)("div",{className:"duration:200 flex w-full cursor-pointer items-center rounded-md py-3 px-3 transition-colors hover:bg-gray-500/10",children:[(0,s.jsx)(ec.Z,{size:18}),(0,s.jsx)("input",{ref:x,className:"ml-2 h-[20px] flex-1 overflow-hidden overflow-ellipsis border-b border-neutral-400 bg-transparent pr-1 text-[12.5px] leading-3 text-left text-white outline-none focus:border-neutral-100",type:"password",value:o,onChange:e=>i(e.target.value),onKeyDown:u,placeholder:a("API Key")||"API Key"}),(0,s.jsxs)("div",{className:"flex w-[40px]",children:[(0,s.jsx)(j.Z,{className:"ml-auto min-w-[20px] text-neutral-400 hover:text-neutral-100",size:18,onClick:e=>{e.stopPropagation(),m(o)}}),(0,s.jsx)(V.Z,{className:"ml-auto min-w-[20px] text-neutral-400 hover:text-neutral-100",size:18,onClick:e=>{e.stopPropagation(),n(!1),i(t)}})]})]}):(0,s.jsx)(ei,{text:a("OpenAI API Key"),icon:(0,s.jsx)(ec.Z,{size:18}),onClick:()=>n(!0)})},eu=e=>{let{onClearConversations:t}=e,[r,a]=(0,c.useState)(!1),{t:l}=(0,d.$G)("sidebar"),n=()=>{t(),a(!1)};return r?(0,s.jsxs)("div",{className:"flex w-full cursor-pointer items-center rounded-lg py-3 px-3 hover:bg-gray-500/10",children:[(0,s.jsx)(X.Z,{size:18}),(0,s.jsx)("div",{className:"ml-3 flex-1 text-left text-[12.5px] leading-3 text-white",children:l("Are you sure?")}),(0,s.jsxs)("div",{className:"flex w-[40px]",children:[(0,s.jsx)(j.Z,{className:"ml-auto min-w-[20px] mr-1 text-neutral-400 hover:text-neutral-100",size:18,onClick:e=>{e.stopPropagation(),n()}}),(0,s.jsx)(V.Z,{className:"ml-auto min-w-[20px] text-neutral-400 hover:text-neutral-100",size:18,onClick:e=>{e.stopPropagation(),a(!1)}})]})]}):(0,s.jsx)(ei,{text:l("Clear conversations"),icon:(0,s.jsx)(X.Z,{size:18}),onClick:()=>a(!0)})},em=e=>{let{lightMode:t,apiKey:r,conversationsCount:a,onToggleLightMode:l,onApiKeyChange:n,onClearConversations:o,onExportConversations:i,onImportConversations:c}=e,{t:x}=(0,d.$G)("sidebar");return(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-1 border-t border-white/20 pt-1 text-sm",children:[a>0?(0,s.jsx)(eu,{onClearConversations:o}):null,(0,s.jsx)(ed,{onImport:c}),(0,s.jsx)(ei,{text:x("Export conversations"),icon:(0,s.jsx)(el.Z,{size:18}),onClick:()=>i()}),(0,s.jsx)(ei,{text:x("light"===t?"Dark mode":"Light mode"),icon:"light"===t?(0,s.jsx)(es.Z,{size:18}):(0,s.jsx)(en.Z,{size:18}),onClick:()=>l("light"===t?"dark":"light")}),(0,s.jsx)(ex,{apiKey:r,onApiKeyChange:n})]})},ep=e=>{let{loading:t,conversations:r,selectedConversation:a,onSelectConversation:l,onDeleteConversation:n,onUpdateConversation:o}=e;return(0,s.jsx)("div",{className:"flex w-full flex-col gap-1",children:r.slice().reverse().map((e,r)=>(0,s.jsx)(ee,{selectedConversation:a,conversation:e,loading:t,onSelectConversation:l,onDeleteConversation:n,onUpdateConversation:o},r))})},eh=e=>{let{loading:t,conversations:r,lightMode:a,selectedConversation:l,apiKey:n,folders:o,onCreateFolder:i,onDeleteFolder:x,onUpdateFolder:u,onNewConversation:m,onToggleLightMode:p,onSelectConversation:h,onDeleteConversation:g,onToggleSidebar:f,onUpdateConversation:v,onApiKeyChange:b,onClearConversations:w,onExportConversations:j,onImportConversations:y}=e,{t:k}=(0,d.$G)("sidebar"),[N,C]=(0,c.useState)(""),[S,I]=(0,c.useState)(r),z=(e,t)=>{v(e,t),C("")},D=e=>{g(e),C("")},P=e=>{if(e.dataTransfer){let t=JSON.parse(e.dataTransfer.getData("conversation"));v(t,{key:"folderId",value:0}),e.target.style.background="none"}},E=e=>{e.preventDefault()},Z=e=>{e.target.style.background="#343541"},L=e=>{e.target.style.background="none"};return(0,c.useEffect)(()=>{N?I(r.filter(e=>{let t=e.name.toLocaleLowerCase()+" "+e.messages.map(e=>e.content).join(" ");return t.toLowerCase().includes(N.toLowerCase())})):I(r)},[N,r]),(0,s.jsxs)("div",{className:"fixed top-0 bottom-0 z-50 flex h-full w-[260px] flex-none flex-col space-y-2 bg-[#202123] p-2 transition-all sm:relative sm:top-0",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("button",{className:"flex w-[190px] flex-shrink-0 cursor-pointer select-none items-center gap-3 rounded-md border border-white/20 p-3 text-[14px] leading-normal text-white transition-colors duration-200 hover:bg-gray-500/10",onClick:()=>{m(),C("")},children:[(0,s.jsx)(J.Z,{size:18}),k("New chat")]}),(0,s.jsx)("button",{className:"ml-2 flex flex-shrink-0 cursor-pointer items-center gap-3 rounded-md border border-white/20 p-3 text-[14px] leading-normal text-white transition-colors duration-200 hover:bg-gray-500/10",onClick:()=>i(k("New folder")),children:(0,s.jsx)($.Z,{size:18})}),(0,s.jsx)(H.Z,{className:"ml-1 hidden cursor-pointer p-1 text-neutral-300 hover:text-neutral-400 sm:flex",size:32,onClick:f})]}),r.length>1&&(0,s.jsx)(ea,{placeholder:"Search conversations...",searchTerm:N,onSearch:C}),(0,s.jsxs)("div",{className:"flex-grow overflow-auto",children:[o.length>0&&(0,s.jsx)("div",{className:"flex border-b border-white/20 pb-2",children:(0,s.jsx)(er,{searchTerm:N,conversations:S.filter(e=>e.folderId),folders:o,onDeleteFolder:x,onUpdateFolder:u,selectedConversation:l,loading:t,onSelectConversation:h,onDeleteConversation:D,onUpdateConversation:z})}),r.length>0?(0,s.jsx)("div",{className:"h-full pt-2",onDrop:e=>P(e),onDragOver:E,onDragEnter:Z,onDragLeave:L,children:(0,s.jsx)(ep,{loading:t,conversations:S.filter(e=>!e.folderId),selectedConversation:l,onSelectConversation:h,onDeleteConversation:D,onUpdateConversation:z})}):(0,s.jsxs)("div",{className:"flex flex-col gap-3 items-center text-sm leading-normal mt-8 text-white opacity-50",children:[(0,s.jsx)(W.Z,{}),k("No conversations.")]})]}),(0,s.jsx)(em,{lightMode:a,apiKey:n,conversationsCount:r.length,onToggleLightMode:p,onApiKeyChange:b,onClearConversations:w,onExportConversations:j,onImportConversations:y})]})},eg=e=>{let{selectedConversation:t,onNewConversation:r}=e;return(0,s.jsxs)("nav",{className:"flex w-full justify-between bg-[#202123] py-3 px-4",children:[(0,s.jsx)("div",{className:"mr-4"}),(0,s.jsx)("div",{className:"max-w-[240px] overflow-hidden text-ellipsis whitespace-nowrap",children:t.name}),(0,s.jsx)(J.Z,{className:"cursor-pointer hover:text-neutral-400 mr-8",onClick:r})]})};var ef=r(98963),ev=r(92005),eb=r(67421),ew=r(12691);let ej=e=>{let{prompt:t,onClose:r,onUpdatePrompt:a}=e,{t:l}=(0,d.$G)("promptbar"),[n,o]=(0,c.useState)(t.name),[i,x]=(0,c.useState)(t.description),[u,m]=(0,c.useState)(t.content),p=(0,c.useRef)(null),h=(0,c.useRef)(null),g=e=>{"Enter"!==e.key||e.shiftKey||(a({...t,name:n,description:i,content:u.trim()}),r())};return(0,c.useEffect)(()=>{let e=e=>{p.current&&!p.current.contains(e.target)&&window.addEventListener("mouseup",t)},t=e=>{window.removeEventListener("mouseup",t),r()};return window.addEventListener("mousedown",e),()=>{window.removeEventListener("mousedown",e)}},[r]),(0,c.useEffect)(()=>{var e;null===(e=h.current)||void 0===e||e.focus()},[]),(0,s.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-100",onKeyDown:g,children:(0,s.jsx)("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:(0,s.jsxs)("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[(0,s.jsx)("div",{className:"hidden sm:inline-block sm:h-screen sm:align-middle","aria-hidden":"true"}),(0,s.jsxs)("div",{ref:p,className:"dark:border-netural-400 inline-block max-h-[400px] transform overflow-hidden rounded-lg border border-gray-300 bg-white px-4 pt-5 pb-4 text-left align-bottom shadow-xl transition-all dark:bg-[#202123] sm:my-8 sm:max-h-[600px] sm:w-full sm:max-w-lg sm:p-6 sm:align-middle",role:"dialog",children:[(0,s.jsx)("div",{className:"text-sm font-bold text-black dark:text-neutral-200",children:l("Name")}),(0,s.jsx)("input",{ref:h,className:"mt-2 w-full rounded-lg border border-neutral-500 px-4 py-2 text-neutral-900 shadow focus:outline-none dark:border-neutral-800 dark:border-opacity-50 dark:bg-[#40414F] dark:text-neutral-100",placeholder:l("A name for your prompt.")||"",value:n,onChange:e=>o(e.target.value)}),(0,s.jsx)("div",{className:"mt-6 text-sm font-bold text-black dark:text-neutral-200",children:l("Description")}),(0,s.jsx)("textarea",{className:"mt-2 w-full rounded-lg border border-neutral-500 px-4 py-2 text-neutral-900 shadow focus:outline-none dark:border-neutral-800 dark:border-opacity-50 dark:bg-[#40414F] dark:text-neutral-100",style:{resize:"none"},placeholder:l("A description for your prompt.")||"",value:i,onChange:e=>x(e.target.value),rows:3}),(0,s.jsx)("div",{className:"mt-6 text-sm font-bold text-black dark:text-neutral-200",children:l("Prompt")}),(0,s.jsx)("textarea",{className:"mt-2 w-full rounded-lg border border-neutral-500 px-4 py-2 text-neutral-900 shadow focus:outline-none dark:border-neutral-800 dark:border-opacity-50 dark:bg-[#40414F] dark:text-neutral-100",style:{resize:"none"},placeholder:l("Prompt content. Use {{}} to denote a variable. Ex: {{name}} is a {{adjective}} {{noun}}")||"",value:u,onChange:e=>m(e.target.value),rows:10}),(0,s.jsx)("button",{type:"button",className:"w-full px-4 py-2 mt-6 border rounded-lg shadow border-neutral-500 text-neutral-900 hover:bg-neutral-100 focus:outline-none dark:border-neutral-800 dark:border-opacity-50 dark:bg-white dark:text-black dark:hover:bg-neutral-300",onClick:()=>{let e={...t,name:n,description:i,content:u.trim()};a(e),r()},children:l("Save")})]})]})})})},ey=e=>{let{prompt:t,onUpdatePrompt:r,onDeletePrompt:a}=e,[l,n]=(0,c.useState)(!1),[o,i]=(0,c.useState)(!1),[d,x]=(0,c.useState)(!1),[u,m]=(0,c.useState)(""),p=(e,t)=>{e.dataTransfer&&e.dataTransfer.setData("prompt",JSON.stringify(t))};return(0,c.useEffect)(()=>{d?i(!1):o&&x(!1)},[d,o]),(0,s.jsxs)("div",{className:"relative flex items-center",children:[(0,s.jsxs)("button",{className:"flex w-full cursor-pointer items-center gap-3 rounded-lg p-3 text-sm transition-colors duration-200 hover:bg-[#343541]/90",draggable:"true",onClick:e=>{e.stopPropagation(),n(!0)},onDragStart:e=>p(e,t),onMouseLeave:()=>{i(!1),x(!1),m("")},children:[(0,s.jsx)(ew.Z,{size:18}),(0,s.jsx)("div",{className:"relative max-h-5 flex-1 overflow-hidden text-ellipsis whitespace-nowrap break-all text-left text-[12.5px] leading-3",children:t.name})]}),(o||d)&&(0,s.jsxs)("div",{className:"absolute right-1 z-10 flex text-gray-300",children:[(0,s.jsx)("button",{className:"min-w-[20px] p-1 text-neutral-400 hover:text-neutral-100",onClick:e=>{e.stopPropagation(),o&&a(t),i(!1)},children:(0,s.jsx)(j.Z,{size:18})}),(0,s.jsx)("button",{className:"min-w-[20px] p-1 text-neutral-400 hover:text-neutral-100",onClick:e=>{e.stopPropagation(),i(!1)},children:(0,s.jsx)(V.Z,{size:18})})]}),!o&&!d&&(0,s.jsx)("div",{className:"absolute right-1 z-10 flex text-gray-300",children:(0,s.jsx)("button",{className:"min-w-[20px] p-1 text-neutral-400 hover:text-neutral-100",onClick:e=>{e.stopPropagation(),i(!0)},children:(0,s.jsx)(X.Z,{size:18})})}),l&&(0,s.jsx)(ej,{prompt:t,onClose:()=>n(!1),onUpdatePrompt:r})]})},ek=e=>{let{searchTerm:t,prompts:r,currentFolder:a,onDeleteFolder:l,onUpdateFolder:n,onDeletePrompt:o,onUpdatePrompt:i}=e,[d,x]=(0,c.useState)(!1),[u,m]=(0,c.useState)(!1),[p,h]=(0,c.useState)(""),[g,f]=(0,c.useState)(!1),v=e=>{"Enter"===e.key&&(e.preventDefault(),b())},b=()=>{n(a.id,p),h(""),m(!1)},w=(e,t)=>{if(e.dataTransfer){f(!0);let r=JSON.parse(e.dataTransfer.getData("prompt")),a={...r,folderId:t.id};i(a),e.target.style.background="none"}},y=e=>{e.preventDefault()},k=e=>{e.target.style.background="#343541"},N=e=>{e.target.style.background="none"};return(0,c.useEffect)(()=>{u?x(!1):d&&m(!1)},[u,d]),(0,c.useEffect)(()=>{t?f(!0):f(!1)},[t]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"relative flex items-center",children:[u?(0,s.jsxs)("div",{className:"flex w-full items-center gap-3 bg-[#343541]/90 p-3",children:[g?(0,s.jsx)(B.Z,{size:18}):(0,s.jsx)(Y.Z,{size:18}),(0,s.jsx)("input",{className:"mr-12 flex-1 overflow-hidden overflow-ellipsis border-neutral-400 bg-transparent text-left text-[12.5px] leading-3 text-white outline-none focus:border-neutral-100",type:"text",value:p,onChange:e=>h(e.target.value),onKeyDown:v,autoFocus:!0})]}):(0,s.jsxs)("button",{className:"flex w-full cursor-pointer items-center gap-3 rounded-lg p-3 text-sm transition-colors duration-200 hover:bg-[#343541]/90",onClick:()=>f(!g),onDrop:e=>w(e,a),onDragOver:y,onDragEnter:k,onDragLeave:N,children:[g?(0,s.jsx)(B.Z,{size:18}):(0,s.jsx)(Y.Z,{size:18}),(0,s.jsx)("div",{className:"relative max-h-5 flex-1 overflow-hidden text-ellipsis whitespace-nowrap break-all text-left text-[12.5px] leading-3",children:a.name})]}),(d||u)&&(0,s.jsxs)("div",{className:"absolute right-1 z-10 flex text-gray-300",children:[(0,s.jsx)("button",{className:"min-w-[20px] p-1 text-neutral-400 hover:text-neutral-100",onClick:e=>{e.stopPropagation(),d?l(a.id):u&&b(),x(!1),m(!1)},children:(0,s.jsx)(j.Z,{size:18})}),(0,s.jsx)("button",{className:"min-w-[20px] p-1 text-neutral-400 hover:text-neutral-100",onClick:e=>{e.stopPropagation(),x(!1),m(!1)},children:(0,s.jsx)(V.Z,{size:18})})]}),!d&&!u&&(0,s.jsxs)("div",{className:"absolute right-1 z-10 flex text-gray-300",children:[(0,s.jsx)("button",{className:"min-w-[20px] p-1 text-neutral-400 hover:text-neutral-100",onClick:e=>{e.stopPropagation(),m(!0),h(a.name)},children:(0,s.jsx)(q.Z,{size:18})}),(0,s.jsx)("button",{className:"min-w-[20px] p-1 text-neutral-400 hover:text-neutral-100",onClick:e=>{e.stopPropagation(),x(!0)},children:(0,s.jsx)(X.Z,{size:18})})]})]}),g?r.map((e,t)=>{if(e.folderId===a.id)return(0,s.jsx)("div",{className:"ml-5 gap-2 border-l pl-2",children:(0,s.jsx)(ey,{prompt:e,onDeletePrompt:o,onUpdatePrompt:i})},t)}):null]})},eN=e=>{let{searchTerm:t,prompts:r,folders:a,onDeleteFolder:l,onUpdateFolder:n,onDeletePrompt:o,onUpdatePrompt:i}=e;return(0,s.jsx)("div",{className:"flex w-full flex-col pt-2",children:a.map((e,a)=>(0,s.jsx)(ek,{searchTerm:t,prompts:r.filter(e=>e.folderId),currentFolder:e,onDeleteFolder:l,onUpdateFolder:n,onDeletePrompt:o,onUpdatePrompt:i},a))})},eC=()=>(0,s.jsx)("div",{}),eS=e=>{let{prompts:t,onUpdatePrompt:r,onDeletePrompt:a}=e;return(0,s.jsx)("div",{className:"flex w-full flex-col gap-1",children:t.slice().reverse().map((e,t)=>(0,s.jsx)(ey,{prompt:e,onUpdatePrompt:r,onDeletePrompt:a},t))})},eI=e=>{let{folders:t,prompts:r,onCreateFolder:a,onDeleteFolder:l,onUpdateFolder:n,onCreatePrompt:o,onUpdatePrompt:i,onDeletePrompt:d,onToggleSidebar:x}=e,{t:u}=(0,eb.$G)("promptbar"),[m,p]=(0,c.useState)(""),[h,g]=(0,c.useState)(r),f=e=>{i(e),p("")},v=e=>{d(e),p("")},b=e=>{if(e.dataTransfer){let t=JSON.parse(e.dataTransfer.getData("prompt")),r={...t,folderId:e.target.dataset.folderId};i(r),e.target.style.background="none"}},w=e=>{e.preventDefault()},j=e=>{e.target.style.background="#343541"},y=e=>{e.target.style.background="none"};return(0,c.useEffect)(()=>{m?g(r.filter(e=>{let t=e.name.toLowerCase()+" "+e.description.toLowerCase()+" "+e.content.toLowerCase();return t.includes(m.toLowerCase())})):g(r)},[m,r]),(0,s.jsxs)("div",{className:"fixed top-0 right-0 z-50 flex h-full w-[260px] flex-none flex-col space-y-2 bg-[#202123] p-2 text-[14px] transition-all sm:relative sm:top-0",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("button",{className:"text-sidebar flex w-[190px] flex-shrink-0 cursor-pointer select-none items-center gap-3 rounded-md border border-white/20 p-3 text-white transition-colors duration-200 hover:bg-gray-500/10",onClick:()=>{o(),p("")},children:[(0,s.jsx)(J.Z,{size:16}),u("New prompt")]}),(0,s.jsx)("button",{className:"flex items-center flex-shrink-0 gap-3 p-3 ml-2 text-sm text-white transition-colors duration-200 border rounded-md cursor-pointer border-white/20 hover:bg-gray-500/10",onClick:()=>a(u("New folder")),children:(0,s.jsx)($.Z,{size:16})}),(0,s.jsx)(ef.Z,{className:"hidden p-1 ml-1 cursor-pointer text-neutral-300 hover:text-neutral-400 sm:flex",size:32,onClick:x})]}),r.length>1&&(0,s.jsx)(ea,{placeholder:u("Search prompts...")||"",searchTerm:m,onSearch:p}),(0,s.jsxs)("div",{className:"flex-grow overflow-auto",children:[t.length>0&&(0,s.jsx)("div",{className:"flex pb-2 border-b border-white/20",children:(0,s.jsx)(eN,{searchTerm:m,prompts:h,folders:t,onUpdateFolder:n,onDeleteFolder:l,onDeletePrompt:v,onUpdatePrompt:f})}),r.length>0?(0,s.jsx)("div",{className:"h-full pt-2",onDrop:e=>b(e),onDragOver:w,onDragEnter:j,onDragLeave:y,children:(0,s.jsx)(eS,{prompts:h.filter(e=>!e.folderId),onUpdatePrompt:f,onDeletePrompt:v})}):(0,s.jsxs)("div",{className:"mt-8 text-center text-white opacity-50 select-none",children:[(0,s.jsx)(ev.Z,{className:"mx-auto mb-3"}),(0,s.jsx)("span",{className:"text-[14px] leading-normal",children:u("No prompts.")})]})]}),(0,s.jsx)(eC,{})]})};(a=l||(l={})).GPT_3_5="gpt-3.5-turbo",a.GPT_4="gpt-4",l.GPT_3_5;let ez={[l.GPT_3_5]:{id:l.GPT_3_5,name:"GPT-3.5",maxLength:12e3,tokenLimit:3e3},[l.GPT_4]:{id:l.GPT_4,name:"GPT-4",maxLength:24e3,tokenLimit:6e3}},eD=e=>{let t=e;return t.model||(t={...t,model:t.model||ez[l.GPT_3_5]}),t.prompt||(t={...t,prompt:t.prompt||G}),t.folderId||(t={...t,folderId:t.folderId||null}),t},eP=e=>Array.isArray(e)?e.reduce((e,t)=>{try{t.model||(t.model=ez[l.GPT_3_5]),t.prompt||(t.prompt=G),t.folderId||(t.folderId=null),e.push(t)}catch(e){console.warn("error while cleaning conversations' history. Removing culprit",e)}return e},[]):(console.warn("history is not an array. Returning an empty array."),[]),eE=(e,t)=>{let r=t.map(t=>t.id===e.id?e:t);return eZ(e),eL(r),{single:e,all:r}},eZ=e=>{localStorage.setItem("selectedConversation",JSON.stringify(e))},eL=e=>{localStorage.setItem("conversationHistory",JSON.stringify(e))},eT=e=>{localStorage.setItem("folders",JSON.stringify(e))},eO=()=>{let e=localStorage.getItem("conversationHistory"),t=localStorage.getItem("folders");e&&(e=JSON.parse(e)),t&&(t=JSON.parse(t));let r={version:3,history:e||[],folders:t||[]},a=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),l=URL.createObjectURL(a),s=document.createElement("a");s.download="chatbot_ui_history_".concat(function(){let e=new Date,t=e.getMonth()+1,r=e.getDate();return"".concat(t,"-").concat(r)}(),".json"),s.href=l,s.style.display="none",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(l)},e_=e=>{let t=function(e){if(Array.isArray(e))return{version:3,history:eP(e),folders:[]};if(!("version"in e)&&"folders"in e&&"history"in e)return{version:3,history:eP(e.history||[]),folders:(e.folders||[]).map(e=>({id:e.id.toString(),name:e.name,type:"chat"}))};if(3===e.version)return e;throw Error("Unsupported data format")}(e),r=t.history;return localStorage.setItem("conversationHistory",JSON.stringify(r)),localStorage.setItem("selectedConversation",JSON.stringify(r[r.length-1])),localStorage.setItem("folders",JSON.stringify(t.folders)),t},eA=e=>{localStorage.setItem("prompts",JSON.stringify(e))};var eU=r(9008),eF=r.n(eU),eR=r(57632);let eG=e=>{let{serverSideApiKeyIsSet:t,defaultModelId:r}=e,{t:a}=(0,d.$G)("chat"),[l,n]=(0,c.useState)(""),[o,i]=(0,c.useState)(!1),[x,u]=(0,c.useState)("dark"),[m,p]=(0,c.useState)(!1),[h,g]=(0,c.useState)(null),[f,v]=(0,c.useState)([]),[b,w]=(0,c.useState)([]),[j,y]=(0,c.useState)([]),[k,N]=(0,c.useState)(),[C,S]=(0,c.useState)(),[I,z]=(0,c.useState)(!0),[D,P]=(0,c.useState)([]),[E,Z]=(0,c.useState)(!0),L=(0,c.useRef)(!1),T=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(k){let r;if(t){let a=[...k.messages];for(let e=0;e<t;e++)a.pop();r={...k,messages:[...a,e]}}else r={...k,messages:[...k.messages,e]};N(r),i(!0),p(!0);let a={model:r.model,messages:r.messages,key:l,prompt:r.prompt},s=new AbortController,n=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},signal:s.signal,body:JSON.stringify(a)});if(!n.ok){i(!1),p(!1);return}let o=n.body;if(!o){i(!1),p(!1);return}if(1===r.messages.length){let{content:t}=e,a=t.length>30?t.substring(0,30)+"...":t;r={...r,name:a}}i(!1);let d=o.getReader(),c=new TextDecoder,x=!1,u=!0,m="";for(;!x;){if(!0===L.current){s.abort(),x=!0;break}let{value:e,done:t}=await d.read();x=t;let a=c.decode(e);if(m+=a,u){u=!1;let e=[...r.messages,{role:"assistant",content:a}];N(r={...r,messages:e})}else{let e=r.messages.map((e,t)=>t===r.messages.length-1?{...e,content:m}:e);N(r={...r,messages:e})}}eZ(r);let h=j.map(e=>e.id===k.id?r:e);0===h.length&&h.push(r),y(h),eL(h),p(!1)}},O=async e=>{let t={title:a("Error fetching models."),code:null,messageLines:[a("Make sure your OpenAI API key is set in the bottom left of the sidebar."),a("If you completed this step, OpenAI may be experiencing issues.")]},r=await fetch("/api/models",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:e})});if(!r.ok){try{var l,s;let e=await r.json();Object.assign(t,{code:null===(l=e.error)||void 0===l?void 0:l.code,messageLines:[null===(s=e.error)||void 0===s?void 0:s.message]})}catch(e){}g(t);return}let n=await r.json();if(!n){g(t);return}v(n),g(null)},_=e=>{u(e),localStorage.setItem("theme",e)},A=e=>{n(e),localStorage.setItem("apiKey",e)},U=()=>{z(!I),localStorage.setItem("showChatbar",JSON.stringify(!I))},F=()=>{Z(!E),localStorage.setItem("showPromptbar",JSON.stringify(!E))},R=()=>{eO()},M=e=>{let{history:t,folders:r}=e_(e);y(t),N(t[t.length-1]),w(r)},J=e=>{N(e),eZ(e)},$=(e,t)=>{let r={id:(0,eR.Z)(),name:e,type:t},a=[...b,r];w(a),eT(a)},W=e=>{let t=b.filter(t=>t.id!==e);w(t),eT(t);let r=j.map(t=>t.folderId===e?{...t,folderId:null}:t);y(r),eL(r);let a=D.map(t=>t.folderId===e?{...t,folderId:null}:t);P(a),eA(a)},B=(e,t)=>{let r=b.map(r=>r.id===e?{...r,name:t}:r);w(r),eT(r)},Y=()=>{let e=j[j.length-1],t={id:(0,eR.Z)(),name:"".concat(a("New Conversation")),messages:[],model:(null==e?void 0:e.model)||{id:ez[r].id,name:ez[r].name,maxLength:ez[r].maxLength,tokenLimit:ez[r].tokenLimit},prompt:G,folderId:null},l=[...j,t];N(t),y(l),eZ(t),eL(l),i(!1)},V=e=>{let t=j.filter(t=>t.id!==e.id);y(t),eL(t),t.length>0?(N(t[t.length-1]),eZ(t[t.length-1])):(N({id:(0,eR.Z)(),name:"New conversation",messages:[],model:ez[r],prompt:G,folderId:null}),localStorage.removeItem("selectedConversation"))},q=(e,t)=>{let r={...e,[t.key]:t.value},{single:a,all:l}=eE(r,j);N(a),y(l)},X=()=>{y([]),localStorage.removeItem("conversationHistory"),N({id:(0,eR.Z)(),name:"New conversation",messages:[],model:ez[r],prompt:G,folderId:null}),localStorage.removeItem("selectedConversation");let e=b.filter(e=>"chat"!==e.type);w(e),eT(e)},Q=(e,t)=>{if(k){let r=k.messages.map((e,r)=>{if(r<t)return e}).filter(e=>e),a={...k,messages:r},{single:l,all:s}=eE(a,j);N(l),y(s),S(e)}},ee=()=>{D[D.length-1];let e={id:(0,eR.Z)(),name:"Prompt ".concat(D.length+1),description:"",content:"",model:ez[r],folderId:null},t=[...D,e];P(t),eA(t)},et=e=>{let t=D.map(t=>t.id===e.id?e:t);P(t),eA(t)},er=e=>{let t=D.filter(t=>t.id!==e.id);P(t),eA(t)};return(0,c.useEffect)(()=>{C&&(T(C),S(void 0))},[C]),(0,c.useEffect)(()=>{window.innerWidth<640&&z(!1)},[k]),(0,c.useEffect)(()=>{l&&O(l)},[l]),(0,c.useEffect)(()=>{let e=localStorage.getItem("theme");e&&u(e);let a=localStorage.getItem("apiKey");a?(n(a),O(a)):t&&O(""),window.innerWidth<640&&z(!1);let l=localStorage.getItem("showChatbar");l&&z("true"===l);let s=localStorage.getItem("showPromptbar");s&&Z("true"===s);let o=localStorage.getItem("folders");o&&w(JSON.parse(o));let i=localStorage.getItem("prompts");i&&P(JSON.parse(i));let d=localStorage.getItem("conversationHistory");if(d){let e=JSON.parse(d),t=eP(e);y(t)}let c=localStorage.getItem("selectedConversation");if(c){let e=JSON.parse(c),t=eD(e);N(t)}else N({id:(0,eR.Z)(),name:"New conversation",messages:[],model:ez[r],prompt:G,folderId:null})},[t]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(eF(),{children:[(0,s.jsx)("title",{children:"Chatbot UI"}),(0,s.jsx)("meta",{name:"description",content:"ChatGPT but better."}),(0,s.jsx)("meta",{name:"viewport",content:"height=device-height ,width=device-width, initial-scale=1, user-scalable=no"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),k&&(0,s.jsxs)("main",{className:"flex h-screen w-screen flex-col text-sm text-white dark:text-white ".concat(x),children:[(0,s.jsx)("div",{className:"fixed top-0 w-full sm:hidden",children:(0,s.jsx)(eg,{selectedConversation:k,onNewConversation:Y})}),(0,s.jsxs)("div",{className:"flex h-full w-full pt-[48px] sm:pt-0",children:[I?(0,s.jsxs)("div",{children:[(0,s.jsx)(eh,{loading:m,conversations:j,lightMode:x,selectedConversation:k,apiKey:l,folders:b.filter(e=>"chat"===e.type),onToggleLightMode:_,onCreateFolder:e=>$(e,"chat"),onDeleteFolder:W,onUpdateFolder:B,onNewConversation:Y,onSelectConversation:J,onDeleteConversation:V,onToggleSidebar:U,onUpdateConversation:q,onApiKeyChange:A,onClearConversations:X,onExportConversations:R,onImportConversations:M}),(0,s.jsx)("button",{className:"fixed top-5 left-[270px] z-50 h-7 w-7 hover:text-gray-400 dark:text-white dark:hover:text-gray-300 sm:top-0.5 sm:left-[270px] sm:h-8 sm:w-8 sm:text-neutral-700",onClick:U,children:(0,s.jsx)(H.Z,{})}),(0,s.jsx)("div",{onClick:U,className:"absolute top-0 left-0 z-10 h-full w-full bg-black opacity-70 sm:hidden"})]}):(0,s.jsx)("button",{className:"fixed top-2.5 left-4 z-50 h-7 w-7 text-white hover:text-gray-400 dark:text-white dark:hover:text-gray-300 sm:top-0.5 sm:left-4 sm:h-8 sm:w-8 sm:text-neutral-700",onClick:U,children:(0,s.jsx)(ef.Z,{})}),(0,s.jsx)("div",{className:"flex flex-1",children:(0,s.jsx)(K,{conversation:k,messageIsStreaming:m,apiKey:l,serverSideApiKeyIsSet:t,defaultModelId:r,modelError:h,models:f,loading:o,prompts:D,onSend:T,onUpdateConversation:q,onEditMessage:Q,stopConversationRef:L})}),E?(0,s.jsxs)("div",{children:[(0,s.jsx)(eI,{prompts:D,folders:b.filter(e=>"prompt"===e.type),onToggleSidebar:F,onCreatePrompt:ee,onUpdatePrompt:et,onDeletePrompt:er,onCreateFolder:e=>$(e,"prompt"),onDeleteFolder:W,onUpdateFolder:B}),(0,s.jsx)("button",{className:"fixed top-5 right-[270px] z-50 h-7 w-7 hover:text-gray-400 dark:text-white dark:hover:text-gray-300 sm:top-0.5 sm:right-[270px] sm:h-8 sm:w-8 sm:text-neutral-700",onClick:F,children:(0,s.jsx)(ef.Z,{})}),(0,s.jsx)("div",{onClick:F,className:"absolute top-0 left-0 z-10 h-full w-full bg-black opacity-70 sm:hidden"})]}):(0,s.jsx)("button",{className:"fixed top-2.5 right-4 z-50 h-7 w-7 text-white hover:text-gray-400 dark:text-white dark:hover:text-gray-300 sm:top-0.5 sm:right-4 sm:h-8 sm:w-8 sm:text-neutral-700",onClick:F,children:(0,s.jsx)(H.Z,{})})]})]})]})};var eM=!0,eK=eG}},function(e){e.O(0,[879,989,774,888,179],function(){return e(e.s=48312)}),_N_E=e.O()}]);